<!-- View all messages received by Contact us page in Page view-->
<!DOCTYPE html>
<html lang="en">
<head>
  <title>View Received Messages</title>
  <!-- Bootstrap CSS -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <style>
    body {
      font-family: Arial, sans-serif;
    }

    .message-table th {
      background-color: #f2f2f2;
      color: #1f11ea;
    }

    h1, p {
      color: #1f11ea;
    }

    /* Column widths */
    .message-table td:nth-child(1),
    .message-table th:nth-child(5) {
      width: 15%;
    }

    .table td, .table th {
      text-align: left;
      vertical-align: top;
    }
  </style>
</head>

<body>
  <%- include('partials/header.ejs') %>
  <%- include('partials/navbar2.ejs') %>

  <div class="container mt-4 mb-5">
    <h1 class="mb-4">Received Messages</h1>
     <!-- Export button positioned at top right -->
     <div class="d-flex justify-content-end mb-3">
      <a href="/export-register" class="btn btn-success">Export to CSV</a>
  </div>

    <% if (messages.length > 0) { %>
      <!-- <div class="table-responsive"> -->
        <div class="table-responsive" style="max-height: 500px; overflow: auto;">  
        <table class="table table-bordered message-table">
          <thead class="text-center">
            <tr>
              <th>Name</th>
              <th>Email</th>
              <th>Phone</th>
              <th>Message</th>
              <th>Received</th>
            </tr>
          </thead>
          <tbody>
            <% messages.forEach(msg => { %>
              <tr>
                <td><%= msg.fname %> <%= msg.lname %></td>
                <td><a href="mailto:<%= msg.email %>"><%= msg.email %></a></td>
                <td><%= msg.phone %></td>
                <td><%= msg.message %></td>
                <td><%= msg.submitted_at.toLocaleString() %></td>
              </tr>
            <% }) %>
          </tbody>
        </table>
      </div>

      <!-- Pagination -->
       <br>
<nav aria-label="Page navigation">
  <ul class="pagination justify-content-center">

    <!-- Previous button -->
    <li class="page-item <%= currentPage === 1 ? 'disabled' : '' %>">
      <a class="page-link" href="?page=<%= currentPage - 1 %>" tabindex="-1">Previous</a>
    </li>

    <!-- Page numbers -->
    <% for (let i = 1; i <= totalPages; i++) { %>
      <li class="page-item <%= currentPage === i ? 'active' : '' %>">
        <a class="page-link" href="?page=<%= i %>"><%= i %></a>
      </li>
    <% } %>

    <!-- Next button -->
    <li class="page-item <%= currentPage === totalPages ? 'disabled' : '' %>">
      <!-- <a class="page-link" href="?page=<%= currentPage + 1 %>">Next</a> -->
    </li>
  </ul>
</nav>

      <br>
      <div class="d-flex justify-content-between align-items-center mt-3">
        <a href="/membersOnly" class="btn btn-secondary">Back to Admin Panel</a>
        <!-- <a href="/export-messages" class="btn btn-success">Export to CSV</a> -->
      </div>
    <% } else { %>
      <p>No messages found.</p>
      <a href="/membersOnly" class="btn btn-secondary mt-3">Back to Admin Panel</a>
    <% } %>
  </div>

  <%- include('partials/footer') %>
</body>
</html>
